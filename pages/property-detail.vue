<template>
  <div>
    <section class="hero_in prjcts_detail">
      <div class="wrapper">
        <div class="container">
          <h1 class="fadeInUp"><span></span>Concorde Manhattans Project</h1>
        </div>
        <span class="magnific-gallery">
          <a
            href="img/gallery/prjct_list_1.jpg"
            class="btn_photos"
            title="Photo title"
            data-effect="mfp-zoom-in"
            >View photos</a
          >
          <a
            href="img/gallery/prjct_list_2.jpg"
            title="Photo title"
            data-effect="mfp-zoom-in"
          ></a>
          <a
            href="img/gallery/prjct_list_3.jpg"
            title="Photo title"
            data-effect="mfp-zoom-in"
          ></a>
        </span>
      </div>
    </section>
    <!--/hero_in-->

    <div class="bg_color_1">
      <nav class="secondary_nav sticky_horizontal">
        <div class="container">
          <ul class="clearfix">
            <li>
              <a href="#overview" class="active">Overview</a>
            </li>

            <li>
              <a href="#gallery">Gallery</a>
            </li>
            <li>
              <a href="#location">Location</a>
            </li>
            <li>
              <a href="#sidebar">Request</a>
            </li>
          </ul>
        </div>
      </nav>
      <div class="container margin_60_35">
        <div class="row">
          <div class="col-lg-8">
            <section id="overview">
              <h2>Overview</h2>
              <p>
                Per consequat adolescens ex, cu nibh commune
                <strong>temporibus vim</strong>, ad sumo viris eloquentiam sed.
                Mea appareat omittantur eloquentiam ad, nam ei quas oportere
                democritum. Prima causae admodum id est, ei timeam inimicus sed.
                Sit an meis aliquam, cetero inermis vel ut. An sit illum euismod
                facilisis, tamquam vulputate pertinacia eum at.
              </p>
              <div class="row" style="text-align: center">
                <div class="col-lg-12">
                  <p>
                    <span><h2>87.61 Lakhs</h2></span> @
                    <strong>7295/sq.ft</strong> as per carpet area
                  </p>
                </div>
                <br />
                <div class="col-lg-4">
                  <p>
                    Super Built-Up Area<br /><strong>1593 Sq.ft</strong
                    ><small> (147.99 Sq.m)</small>
                  </p>
                </div>
                <div class="col-lg-4">
                  <p>
                    Carpet Area<br /><strong>1201 Sq.ft </strong
                    ><small> (111.58 Sq.m)</small>
                  </p>
                </div>
                <div class="col-lg-4">
                  <p>Bedrooms<br /><strong>2</strong></p>
                </div>

                <div class="col-lg-4">
                  <p>Bathrooms<br /><strong>2</strong></p>
                </div>
                <div class="col-lg-4">
                  <p>Availability from<br /><strong>Ready to Move</strong></p>
                </div>
                <div class="col-lg-4">
                  <p>Condition<br /><strong>For sale</strong></p>
                </div>
              </div>

              <section id="gallery">
                <h3>Gallery</h3>
                <div class="row">
                  <div class="col-lg-4">
                    <img
                      src="img/hero_in_prjcts_detail.jpg"
                      alt=""
                      width="250px"
                    />
                  </div>
                  <div class="col-lg-4">
                    <img src="img/home_section_1.jpg" alt="" width="250px" />
                  </div>
                  <div class="col-lg-4">
                    <img src="img/hero_in_bg_4.jpg" alt="" width="250px" />
                  </div>
                </div>
                <hr />
                <p>
                  Amenities
                  <strong> </strong>
                </p>
                <div class="row">
                  <div class="col-lg-2">
                    <a class="box_feat icon-p-sm" href="#0">
                      <figure>
                        <img
                          src="img/amenities/gym.svg"
                          alt=""
                          class="imgsize"
                        />
                      </figure>
                      <p><small>Gym</small></p>
                    </a>
                  </div>
                  <div class="col-lg-2">
                    <a class="box_feat icon-p-sm" href="#0">
                      <figure>
                        <img
                          src="img/amenities/Beauty parlor.svg"
                          alt=""
                          class="imgsize"
                        />
                      </figure>
                      <p><small>Beauty parlor</small></p>
                    </a>
                  </div>
                  <div class="col-lg-2">
                    <a class="box_feat icon-p-sm" href="#0">
                      <figure>
                        <img
                          src="img/amenities/lounge.svg"
                          alt=""
                          class="imgsize"
                        />
                      </figure>
                      <p><small>Lounge</small></p>
                    </a>
                  </div>
                  <div class="col-lg-2">
                    <a class="box_feat icon-p-sm" href="#0">
                      <figure>
                        <img
                          src="img/amenities/Management.svg"
                          alt=""
                          class="imgsize"
                        />
                      </figure>
                      <p><small>Managemen</small></p>
                    </a>
                  </div>
                  <div class="col-lg-2">
                    <a class="box_feat icon-p-sm" href="#0">
                      <figure>
                        <img
                          src="img/amenities/swimming pool.svg"
                          alt=""
                          class="imgsize"
                        />
                      </figure>
                      <p><small>Swimming pool</small></p>
                    </a>
                  </div>
                  <div class="col-lg-2">
                    <a class="box_feat icon-p-sm" href="#0">
                      <figure>
                        <img
                          src="img/amenities/Parking .svg"
                          alt=""
                          class="imgsize"
                        />
                      </figure>
                      <p><small>Parking</small></p>
                    </a>
                  </div>
                </div>
                <br />
              </section>

              <!-- /row -->
              <section id="location">
                <hr />
                <h3>Location</h3>
                <div id="map" class="map map_single add_bottom_30">
                  <div
                    id="ts-map-hero"
                    class="h-100 ts-z-index__1"
                    data-ts-map-leaflet-provider="https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png"
                    data-ts-map-leaflet-attribution="&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> &copy; <a href='http://cartodb.com/attributions'>CartoDB</a>"
                    data-ts-map-zoom-position="bottomright"
                    data-ts-map-scroll-wheel="1"
                    data-ts-map-zoom="11"
                    data-ts-map-center-latitude="12.9716"
                    data-ts-map-center-longitude="77.5946"
                    data-ts-locale="en-US"
                    data-ts-currency="USD"
                    data-ts-unit="m<sup>2</sup>"
                    data-ts-display-additional-info="area_Area;bedrooms_Bedrooms;bathrooms_Bathrooms"
                  ></div>
                </div>

                <!-- End Map -->
              </section>
              <h3>Project Description &amp; Specification</h3>
              <br />
              <p>
                Concorde Group brings you well-designed 2 BHK apartments located
                in electronic city. Midway City offers you a choice of unit
                sizes starting from 1,593 square foot. The amenities available
                in the project include a swimming pool, meditation hall, indoor
                games, gymnasium, clubhouse, health facilities, badminton court,
                play area, Wi-Fi and tennis court. Landscaped garden and private
                terrace are provided for enjoying the serene nature. The social
                infrastructures in the neighbourhood include schools, colleges,
                hospitals, bank branches and hotels. This area is located close
                to the Bangalore-Hosur Highway and the Electronic city flyover.
              </p>
              <div id="instagram-feed" class="clearfix"></div>
              <hr />
            </section>
            <!-- /section -->

            <!-- /section -->
            <hr />
          </div>
          <!-- /col -->

          <aside class="col-lg-4" id="sidebar">
            <div class="box_detail booking">
              <div class>
                <h3>
                  <span>Request Call back</span>
                </h3>
              </div>
              <div class="form-group input-dates">
                <input
                  class="form-control"
                  type="text"
                  id="name_contact"
                  name="name_contact"
                  placeholder="Name"
                />
              </div>
              <div class="form-group input-type">
                <input
                  class="form-control"
                  type="text"
                  id="email"
                  name="email"
                  placeholder="Email"
                />
                <input
                  class="form-control"
                  type="text"
                  id="number"
                  name="number"
                  placeholder="Phone"
                />
              </div>
              <a href="#" class="btn_1 full-width purchase">Call Back</a>
              <nuxt-link
                to=""
                data-toggle="modal"
                data-target="#scdeluform"
                class="btn_1 full-width outline wishlist"
              >
                <i class="icon_time"></i> Schedule Visit ></nuxt-link
              >
              <div
                class="menu_fixed modal fade"
                id="scdeluform"
                tabindex="-1"
                role="dialog"
                aria-labelledby="exampleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">
                        Schedule Time
                      </h5>
                      <button
                        type="button"
                        class="close"
                        data-dismiss="modal"
                        aria-label="Close"
                      >
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <Scheduleform />
                    </div>
                  </div>
                </div>
              </div>
              <a href="wishlist.html" class="btn_1 full-width outline wishlist">
                <i class="icon_heart"></i> Add to wishlist
              </a>
              <div class="text-center">
                <small>No money charged in this step</small>
              </div>
            </div>
            <ul class="share-buttons">
              <li>
                <a class="fb-share" href="#0">
                  <i class="social_facebook"></i> Share
                </a>
              </li>
              <li>
                <a class="twitter-share" href="#0">
                  <i class="social_twitter"></i> Tweet
                </a>
              </li>
              <li>
                <a
                  class="gplus-share"
                  href="https://api.whatsapp.com/send?phone=918095063070&text=Hey"
                >
                  <i class="social_wordpress"></i> Share
                </a>
              </li>
            </ul>
          </aside>
        </div>
        <!-- /row -->
      </div>
      <!-- /container -->
    </div>
    <!-- /bg_color_1 -->
  </div>
  <!--/main-->
</template>
<script>
export default {
  mounted() {
    var mapId = "ts-map-hero";
    //==================================================================================================================
    // VARIABLES
    // =================================================================================================================
    var newMarkers = [];
    var loadedMarkersData = [];
    var allMarkersData;
    var lastMarker;
    var map;
    var markerCluster;
    var $ref = this;
    if ($("#" + mapId).length) {
      //==============================================================================================================
      // MAP SETTINGS
      // =============================================================================================================
      var mapElement = $(document.getElementById(mapId));
      var mapDefaultZoom = parseInt(mapElement.attr("data-ts-map-zoom"), 10);
      var centerLatitude = mapElement.attr("data-ts-map-center-latitude");
      var centerLongitude = mapElement.attr("data-ts-map-center-longitude");
      var locale = mapElement.attr("data-ts-locale");
      var currency = mapElement.attr("data-ts-currency");
      var unit = mapElement.attr("data-ts-unit");
      var controls = parseInt(mapElement.attr("data-ts-map-controls"), 10);
      var scrollWheel = parseInt(
        mapElement.attr("data-ts-map-scroll-wheel"),
        10
      );
      var leafletMapProvider = mapElement.attr("data-ts-map-leaflet-provider");
      var leafletAttribution = mapElement.attr(
        "data-ts-map-leaflet-attribution"
      );
      var zoomPosition = mapElement.attr("data-ts-map-zoom-position");
      var mapBoxAccessToken = mapElement.attr(
        "data-ts-map-mapbox-access-token"
      );
      var mapBoxId = mapElement.attr("data-ts-map-mapbox-id");
      if (mapElement.attr("data-ts-display-additional-info")) {
        var displayAdditionalInfoTemp = mapElement
          .attr("data-ts-display-additional-info")
          .split(";");
        var displayAdditionalInfo = [];
        for (var i = 0; i < displayAdditionalInfoTemp.length; i++) {
          displayAdditionalInfo.push(displayAdditionalInfoTemp[i].split("_"));
        }
      }
      // Default map zoom
      if (!mapDefaultZoom) {
        mapDefaultZoom = 14;
      }
      //==================================================================================================================
      // MAP ELEMENT
      // =================================================================================================================
      map = L.map(mapId, {
        zoomControl: false,
        scrollWheelZoom: scrollWheel,
      });
      map.setView([centerLatitude, centerLongitude], mapDefaultZoom);
      L.tileLayer(leafletMapProvider, {
        attribution: leafletAttribution,
        id: mapBoxId,
        accessToken: mapBoxAccessToken,
      }).addTo(map);
      if (controls !== 0 && zoomPosition) {
        L.control.zoom({ position: zoomPosition }).addTo(map);
      } else if (controls !== 0) {
        L.control.zoom({ position: "topright" }).addTo(map);
      }
      //==================================================================================================================
      // LOAD DATA
      // =================================================================================================================
      loadData();
    }
    async function loadData(parameters) {
      // allMarkersData = await getProperties();
      // loadedMarkersData = allMarkersData;
      // createMarkers();
      // $.ajax({
      //     url: "assets/db/items.json",
      //     dataType: "json",
      //     method: "GET",
      //     cache: false,
      //     success: function (results) {
      //         if (typeof parameters !== "undefined" && parameters["formData"]) {
      //             //loadFormData(parameters);
      //         }
      //         else {
      //             allMarkersData = results;
      //             loadedMarkersData = allMarkersData;
      //         }
      //         createMarkers(); // call function to create markers
      //     },
      //     error: function (e) {
      //         console.log(e);
      //     }
      // });
    }
    //==================================================================================================================
    // Create DIV with the markers data
    // =================================================================================================================
    function createMarkers() {
      markerCluster = L.markerClusterGroup({
        showCoverageOnHover: false,
      });
      for (var i = 0; i < loadedMarkersData.length; i++) {
        var markerContent = document.createElement("div");
        markerContent.innerHTML =
          '<div class="ts-marker-wrapper">' +
          '<a href="#" class="ts-marker" data-ts-id="' +
          loadedMarkersData[i]["id"] +
          '" data-ts-ln="' +
          i +
          '">' +
          (loadedMarkersData[i]["ribbon"] !== undefined
            ? '<div class="ts-marker__feature">' +
              loadedMarkersData[i]["ribbon"] +
              "</div>"
            : "") +
          (loadedMarkersData[i]["title"] !== undefined
            ? '<div class="ts-marker__title">' +
              loadedMarkersData[i]["title"] +
              "</div>"
            : "") +
          (loadedMarkersData[i]["price"] !== undefined &&
          loadedMarkersData[i]["price"] > 0
            ? '<div class="ts-marker__info">' +
              formatPrice(loadedMarkersData[i]["price"]) +
              "</div>"
            : "") +
          (loadedMarkersData[i]["marker_image"] !== undefined
            ? '<div class="ts-marker__image ts-black-gradient" style="background-image: url(' +
              loadedMarkersData[i]["marker_image"] +
              ')"></div>'
            : '<div class="ts-marker__image ts-black-gradient" style="background-image: url(assets/img/marker-default-img.png)"></div>') +
          "</a>" +
          "</div>";
        placeLeafletMarker({
          i: i,
          markerContent: markerContent,
          method: "latitudeLongitude",
        });
      }
      // After the markers are created, do the rest
      markersDone();
    }
    //==================================================================================================================
    // When markers are placed, do the rest
    // =================================================================================================================
    function markersDone() {
      //==================================================================================================================
      // MARKER CLUSTERER
      // =============================================================================================================
      map.addLayer(markerCluster);
      map.on("moveend", createSideBarResult);
      createSideBarResult();
    }
    //==================================================================================================================
    // Google Rich Marker plugin
    // =================================================================================================================
    function placeLeafletMarker(parameters) {
      var i = parameters["i"];
      // Define marker HTML
      var markerIcon = L.divIcon({
        html: parameters["markerContent"].innerHTML,
        iconSize: [42, 47],
        iconAnchor: [0, 47],
      });
      // Attach marker to map
      var marker = L.marker(
        [loadedMarkersData[i]["latitude"], loadedMarkersData[i]["longitude"]],
        {
          icon: markerIcon,
        }
      );
      marker.loopNumber = i;
      markerCluster.addLayer(marker);
      // Open Popup on click
      marker.on("click", function () {
        if (lastMarker && lastMarker._icon) {
          $(lastMarker._icon.firstChild).removeClass("ts-hide-marker");
        }
        openInfobox({
          id: $(this._icon).find(".ts-marker").attr("data-ts-id"),
          parentMarker: marker,
          i: i,
          url: "assets/db/items.json",
        });
      });
      newMarkers.push(marker);
    }
    //==================================================================================================================
    // Open InfoBox on marker click
    // =================================================================================================================
    function openInfobox(parameters) {
      var i = parameters["i"];
      var parentMarker = parameters["parentMarker"];
      var id = parameters["id"];
      var infoboxHtml = document.createElement("div");
      // First create and HTML for infobox
      createInfoBoxHTML({ i: i, infoboxHtml: infoboxHtml });
      //==============================================================================================================
      // Set InfoBox options
      //==============================================================================================================
      var popup = L.popup({
        closeButton: false,
        offset: [120, 0],
        closeOnClick: false,
      })
        .setLatLng([parentMarker._latlng.lat, parentMarker._latlng.lng])
        .setContent(infoboxHtml)
        .openOn(map);
      // Set the new "Last" opened marker
      lastMarker = parentMarker;
      // Hide the current marker, so only InfoBox is visible
      parentMarker._markerIcon = parentMarker._icon.firstChild;
      $(parentMarker._icon.firstChild).addClass("ts-hide-marker");
      setTimeout(function () {
        $(".ts-infobox[data-ts-id='" + id + "']")
          .closest(".infobox-wrapper")
          .addClass("ts-show");
        $(".ts-infobox[data-ts-id='" + id + "'] .ts-close").on(
          "click",
          function () {
            $(".ts-infobox[data-ts-id='" + id + "']")
              .closest(".infobox-wrapper")
              .removeClass("ts-show");
            $(parentMarker._markerIcon).removeClass("ts-hide-marker");
            map.closePopup();
          }
        );
      }, 50);
    }
    //==================================================================================================================
    // Create Infobox HTML element
    //==================================================================================================================
    function createInfoBoxHTML(parameters) {
      var i = parameters["i"];
      var infoboxHtml = parameters["infoboxHtml"];
      infoboxHtml.innerHTML =
        '<div class="infobox-wrapper">' +
        '<div class="ts-infobox" data-ts-id="' +
        loadedMarkersData[i]["id"] +
        '">' +
        '<img src="assets/img/infobox-close.svg" class="ts-close">' +
        (loadedMarkersData[i]["ribbon"] !== undefined
          ? '<div class="ts-ribbon">' +
            loadedMarkersData[i]["ribbon"] +
            "</div>"
          : "") +
        (loadedMarkersData[i]["ribbon_corner"] !== undefined
          ? '<div class="ts-ribbon-corner"><span>' +
            loadedMarkersData[i]["ribbon_corner"] +
            "</span></div>"
          : "") +
        '<a href="' +
        loadedMarkersData[i]["url"] +
        '" class="ts-infobox__wrapper ts-black-gradient">' +
        (loadedMarkersData[i]["badge"] !== undefined &&
        loadedMarkersData[i]["badge"].length > 0
          ? '<div class="badge badge-dark">' +
            loadedMarkersData[i]["badge"] +
            "</div>"
          : "") +
        '<div class="ts-infobox__content">' +
        '<figure class="ts-item__info">' +
        (loadedMarkersData[i]["price"] !== undefined &&
        loadedMarkersData[i]["price"] > 0
          ? '<div class="ts-item__info-badge">' +
            formatPrice(loadedMarkersData[i]["price"]) +
            "</div>"
          : "") +
        (loadedMarkersData[i]["title"] !== undefined &&
        loadedMarkersData[i]["title"].length > 0
          ? "<h4>" + loadedMarkersData[i]["title"] + "</h4>"
          : "") +
        (loadedMarkersData[i]["address"] !== undefined &&
        loadedMarkersData[i]["address"].length > 0
          ? '<aside><i class="fa fa-map-marker mr-2"></i>' +
            loadedMarkersData[i]["address"] +
            "</aside>"
          : "") +
        "</figure>" +
        additionalInfoHTML({ display: displayAdditionalInfo, i: i }) +
        "</div>" +
        '<div class="ts-infobox_image" style="background-image: url(' +
        loadedMarkersData[i]["marker_image"] +
        ')"></div>' +
        "</a>" +
        "</div>" +
        "</div>";
    }
    //==================================================================================================================
    // Create Additional Info HTML element
    //==================================================================================================================
    function additionalInfoHTML(parameters) {
      var i = parameters["i"];
      var displayParameter;
      var additionalInfoHtml = "";
      for (var a = 0; a < parameters["display"].length; a++) {
        displayParameter = parameters["display"][a];
        if (loadedMarkersData[i][displayParameter[0]] !== undefined) {
          additionalInfoHtml +=
            "<dl>" +
            "<dt>" +
            displayParameter[1] +
            "</dt>" +
            "<dd>" +
            loadedMarkersData[i][displayParameter[0]] +
            (displayParameter[a] === "area" ? unit : "") +
            "</dd>" +
            "</dl>";
        }
      }
      if (additionalInfoHtml) {
        return (
          '<div class="ts-description-lists">' + additionalInfoHtml + "</div>"
        );
      } else {
        return "";
      }
    }
    //==================================================================================================================
    // Create SideBar HTML Results
    //==================================================================================================================
    function createSideBarResult() {
      //var visibleMarkersId = [];
      var visibleMarkersOnMap = [];
      var resultsHtml = [];
      for (var i = 0; i < loadedMarkersData.length; i++) {
        //visibleMarkersOnMap.push( newMarkers[i] );
        if (map.getBounds().contains(newMarkers[i].getLatLng())) {
          visibleMarkersOnMap.push(newMarkers[i]);
          //newMarkers[i].addTo(map);
        } else {
          //newMarkers[i].setVisible(false);
          //newMarkers[i].remove();
        }
      }
      //markerCluster.refreshClusters();
      for (i = 0; i < visibleMarkersOnMap.length; i++) {
        var id = visibleMarkersOnMap[i].loopNumber;
        var additionalInfoHtml = "";
        if (loadedMarkersData[id]["additional_info"]) {
          for (
            var a = 0;
            a < loadedMarkersData[id]["additional_info"].length;
            a++
          ) {
            additionalInfoHtml +=
              "<dl>" +
              "<dt>" +
              loadedMarkersData[id]["additional_info"][a]["title"] +
              "</dt>" +
              "<dd>" +
              loadedMarkersData[id]["additional_info"][a]["value"] +
              "</dd>" +
              "</dl>";
          }
        }
        resultsHtml.push(
          '<div class="ts-result-link" data-ts-id="' +
            loadedMarkersData[id]["id"] +
            '" data-ts-ln="' +
            newMarkers[id].loopNumber +
            '">' +
            '<span class="ts-center-marker"><img src="/assets/img/result-center.svg"></span>' +
            '<a href="' +
            loadedMarkersData[id]["url"] +
            '" class="card ts-item ts-card ts-result">' +
            (loadedMarkersData[i]["ribbon"] !== undefined
              ? '<div class="ts-ribbon">' +
                loadedMarkersData[i]["ribbon"] +
                "</div>"
              : "") +
            (loadedMarkersData[i]["ribbon_corner"] !== undefined
              ? '<div class="ts-ribbon-corner"><span>' +
                loadedMarkersData[i]["ribbon_corner"] +
                "</span></div>"
              : "") +
            '<div href="/property-detail" class="card-img ts-item__image" style="background-image: url(' +
            loadedMarkersData[id]["marker_image"] +
            ')"></div>' +
            '<div class="card-body">' +
            '<div class="ts-item__info-badge">' +
            formatPrice(loadedMarkersData[id]["price"]) +
            "</div>" +
            '<figure class="ts-item__info">' +
            "<h4>" +
            loadedMarkersData[id]["title"] +
            "</h4>" +
            "<aside>" +
            '<i class="fa fa-map-marker mr-2"></i>' +
            loadedMarkersData[id]["address"] +
            "</aside>" +
            "</figure>" +
            additionalInfoHTML({ display: displayAdditionalInfo, i: i }) +
            "</div>" +
            '<div class="card-footer">' +
            '<span class="ts-btn-arrow">Detail</span>' +
            "</div>" +
            "</a>" +
            "</div>"
        );
      }
      $ref.properties = resultsHtml;
      var $results = $("#ts-results").find(".ts-sly-frame");
      if ($results.hasClass("ts-loaded")) {
        $results.sly("reload");
      } else {
        initializeSly();
      }
      var resultsBar = $(
        ".scroll-wrapper.ts-results__vertical-list, .scroll-wrapper.ts-results__grid"
      );
      if ($(window).width() < 575) {
        resultsBar.find(".ts-results__vertical").css("pointer-events", "none");
        resultsBar.on("click", function () {
          $(this).addClass("ts-expanded");
          $(this).find(".ts-results__vertical").css("pointer-events", "auto");
          $("#ts-map-hero").addClass("ts-dim-map");
        });
        $("#ts-map-hero").on("click", function () {
          if (resultsBar.hasClass("ts-expanded")) {
            resultsBar.removeClass("ts-expanded");
            $("#ts-map-hero").removeClass("ts-dim-map");
            resultsBar
              .find(".ts-results__vertical")
              .css("pointer-events", "none");
          }
        });
      } else {
        resultsBar.removeClass("ts-expanded");
        resultsBar.find(".ts-results__vertical").css("pointer-events", "auto");
        $("#ts-map-hero").removeClass("ts-dim-map");
      }
    }
    // Center map on result click (Disabled)
    //==============================================================================================================
    $(document).on("click", ".ts-center-marker", function () {
      $(".ts-marker").parent().removeClass("ts-active-marker");
      map.setView(newMarkers[$(this).parent().attr("data-ts-ln")].getLatLng());
      var id = $(this).parent().attr("data-ts-id");
      $(".ts-marker[data-ts-id='" + id + "']")
        .parent()
        .addClass("ts-active-marker");
    });
    // Highlight marker on result hover
    //==============================================================================================================
    var timer;
    $(document).on(
      {
        mouseenter: function () {
          var id = $(this).parent().attr("data-ts-id");
          timer = setTimeout(function () {
            $(".ts-marker").parent().addClass("ts-marker-hide");
            $(".ts-marker[data-ts-id='" + id + "']")
              .parent()
              .addClass("ts-active-marker");
          }, 500);
        },
        mouseleave: function () {
          clearTimeout(timer);
          $(".ts-marker")
            .parent()
            .removeClass("ts-active-marker")
            .removeClass("ts-marker-hide");
        },
      },
      ".ts-result"
    );
    function formatPrice(price) {
      return Number(price)
        .toLocaleString(locale, { style: "currency", currency: currency })
        .replace(/\D\d\d$/, "");
    }
    var simpleMapId = "ts-map-simple";
    if ($("#" + simpleMapId).length) {
      mapElement = $(document.getElementById(simpleMapId));
      mapDefaultZoom = parseInt(mapElement.attr("data-ts-map-zoom"), 10);
      centerLatitude = mapElement.attr("data-ts-map-center-latitude");
      centerLongitude = mapElement.attr("data-ts-map-center-longitude");
      controls = parseInt(mapElement.attr("data-ts-map-controls"), 10);
      scrollWheel = parseInt(mapElement.attr("data-ts-map-scroll-wheel"), 10);
      leafletMapProvider = mapElement.attr("data-ts-map-leaflet-provider");
      var markerDrag = parseInt(mapElement.attr("data-ts-map-marker-drag"), 10);
      if (!mapDefaultZoom) {
        mapDefaultZoom = 14;
      }
      map = L.map(simpleMapId, {
        zoomControl: false,
        scrollWheelZoom: scrollWheel,
      });
      map.setView([centerLatitude, centerLongitude], mapDefaultZoom);
      L.tileLayer(leafletMapProvider, {
        attribution: leafletAttribution,
        id: mapBoxId,
        accessToken: mapBoxAccessToken,
      }).addTo(map);
      controls === 1 ? L.control.zoom({ position: "topright" }).addTo(map) : "";
      var icon = L.icon({
        iconUrl: "/assets/img/img-item-thumb-25.jpg",
        iconSize: [22, 29],
        iconAnchor: [11, 29],
      });
      var marker = L.marker([centerLatitude, centerLongitude], {
        icon: icon,
        draggable: markerDrag,
      }).addTo(map);
    }
  },
};
</script>
